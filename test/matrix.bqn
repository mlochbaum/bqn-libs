m â† â€¢Import "../matrix.bqn"
MPâ€¿qrâ€¿lupâ€¿cholesky â† m

TestDecomp â† {âŸ¨Decompose,Verify,Compose,Inverse,SolveâŸ© ğ•Š m:
  tol â† 1eÂ¯12
  Verify d â† Decompose m
  ! tol â‰¥ âŒˆÂ´â¥Š | m - Compose d
  ! tol â‰¥ âŒˆÂ´â¥Š | (=âŒœÂ´â†•Â¨â‰¢ğ•©) - (Inverse d) MP m
  ! tol â‰¥ âŒˆÂ´â¥Š | (âŠ¢ - m MP d Solve âŠ¢) âŒ½â†•â‰ m
}
qr  TestDecomp 6â€¿6â¥Š4â€¿1â€¿2â€¿5â€¿0â€¿3â€¿6
lup TestDecomp 6â€¿6â¥Š4â€¿1â€¿2â€¿5â€¿0â€¿3â€¿6
cholesky TestDecomp 4â€¿12â€¿Â¯16âˆ¾12â€¿37â€¿Â¯43â‰Â¯16â€¿Â¯43â€¿98

â€¢Out "All passed!"
