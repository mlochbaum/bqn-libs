m â† â€¢Import "../matrix.bqn"
MPâ€¿qrâ€¿lupâ€¿choleskyâ€¿symmetric_eigenâ€¿svdâ€¿real_schurâ€¿Determinantâ€¿Eigenvaluesâ€¿CharPoly â† m

TestDecomp â† {âŸ¨Decompose,Verify,Compose,Inverse,SolveâŸ© ð•Š m:
  tol â† 1eÂ¯12
  Verify d â† Decompose m
  ! tol â‰¥ âŒˆÂ´â¥Š | m - Compose d
  ! tol â‰¥ âŒˆÂ´â¥Š | (=âŒœËœâ†•âŠ¢Â´â‰¢m) - (Inverse d) MP m
  ! tol â‰¥ âŒˆÂ´â¥Š | (âŠ¢ - m MP d Solve âŠ¢) âŒ½â†•â‰ m
}
qr  TestDecomp 6â€¿6â¥Š4â€¿1â€¿2â€¿5â€¿0â€¿3â€¿6
lup TestDecomp 6â€¿6â¥Š4â€¿1â€¿2â€¿5â€¿0â€¿3â€¿6
cholesky TestDecomp [4â€¿12â€¿Â¯16,12â€¿37â€¿Â¯43,Â¯16â€¿Â¯43â€¿98]
symmetric_eigen TestDecomp â‰âŠ¸+ 6â€¿6â¥Š4â€¿1â€¿2â€¿5â€¿0â€¿3â€¿6
svd TestDecomp 6â€¿6â¥Š4â€¿1â€¿2â€¿5â€¿0â€¿3â€¿6

TestNoInv â† {âŸ¨Decompose,Verify,ComposeâŸ© ð•Š m:
  Verify d â† Decompose m
  ! 1eÂ¯12 â‰¥ âŒˆÂ´â¥Š | m - Compose d
}
real_schur TestNoInv 6â€¿6â¥Š4â€¿1â€¿2â€¿5â€¿0â€¿3â€¿6

! 0 â‰¡ Determinant â¥ŠâŸœ(â†•Ã—Â´)9â€¿9
! âˆ§Â´ 1eÂ¯10 > | 1â€¿2â€¿3 - âˆ§ Eigenvalues [Â¯149â€¿Â¯50â€¿Â¯154,537â€¿180â€¿546,Â¯27â€¿Â¯9â€¿Â¯25]
! 1â€¿Â¯10â€¿4â€¿Â¯40 â‰¡ CharPoly [3â€¿1â€¿5,3â€¿3â€¿1,4â€¿6â€¿4]

â€¢Out "All passed!"
