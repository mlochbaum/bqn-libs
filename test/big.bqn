n10 â† âŸ¨10âŸ© â€¢Import "../bignat.bqn"
i10 â† âŸ¨10âŸ© â€¢Import "../bigint.bqn"

_fails â† {0âˆ˜ğ”½âŠ1}

TestNat â† { ğ•Š âŸ¨Add,Sub,Mul,_compare,SignumâŸ©â€¿S:
  ! "41401" â‰¡ "41099" AddâŒ¾S "302"
  ! "" (Addâ‰¡âŠ¢)â—‹S "9120"

  ! SubËœâŠ¸â‰¡ S ""
  ! "" â‰¡ "43" SubâŒ¾S "43"
  ! "43" SubâŒ¾S _fails "44"
  ! "9" SubâŒ¾S _fails "10"
  ! "1" â‰¡ "11" SubâŒ¾S "10"

  ! "121" â‰¡ MulâŒ¾SËœ "11"
  ! "" â‰¡ "3583" MulâŒ¾S ""
  ! "3550753" â‰¡ "3583" MulâŒ¾S "991"

  CC â† {cğ•Šaâ€¿b: ({a ğ•_compare b}Â¨ â‰¡ {cğ•0}Â¨) =â€¿â‰ â€¿<â€¿>â€¿â‰¤â€¿â‰¥}âŸœ(SÂ¨)
  !  1 CC "321"â€¿"234"
  !  0 CC "90"â€¿"90"
  !  0 CC ""â€¿""
  ! Â¯1 CC "99"â€¿"100"

  ! 0 = Signum S ""
  ! 1 = Signum S "1"
}

TestInt â† { ğ•Š âŸ¨Add,Sub,Mul,_compare,SignumâŸ©â€¿S:
  ! "-215" SâŠ¸â‰¡ "-96" Addâ—‹S "-119"
  ! "23" SâŠ¸â‰¡ "-96" Addâ—‹S "119"

  ! "-23" SâŠ¸â‰¡ "96" Subâ—‹S "119"
  ! "-23" SâŠ¸â‰¡ "" Subâ—‹S "23"

  ! "225" SâŠ¸â‰¡ Mulâ—‹SËœ "-15"
  ! "" SâŠ¸â‰¡ "-3583" Mulâ—‹S ""
  ! "-24775" SâŠ¸â‰¡ "25" Mulâ—‹S "-991"

  CC â† {cğ•Šaâ€¿b: ({a ğ•_compare b}Â¨ â‰¡ {cğ•0}Â¨) =â€¿â‰ â€¿<â€¿>â€¿â‰¤â€¿â‰¥}âŸœ(IÂ¨)
  !  1 CC "1"â€¿"-2"
  !  0 CC "-90"â€¿"-90"
  !  0 CC ""â€¿""
  ! Â¯1 CC "-1010"â€¿""

  ! Â¯1 = Signum S "-1"
  ! 0 = Signum S ""
  ! 1 = Signum S "1"
}

Dig â† âŒ½-'0'Ë™
TestNat n10â€¿Dig

IN â† 0 â‰â—‹< Dig
I â† ("-"â‰¡1âŠ¸â†‘)â—¶âŸ¨IN,1âŒ¾âŠ‘Â·IN 1âŠ¸â†“âŸ©
TestNat i10â€¿IN
TestInt i10â€¿I

â€¢Out "All passed!"
