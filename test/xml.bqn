âŸ¨Pâ‡ParseâŸ© â† â€¢Import "../xml.bqn"

_fails â† {0âˆ˜ğ”½âŠ1}
e â† â†•2â€¿0 # No attributes

! P _fails "<"
! P _fails "<tag><</tag>"

! âŸ¨"tag"â€¿eâ€¿âŸ¨âŸ©âŸ© â‰¡ P "<tag></tag>"
! âŸ¨"tag"â€¿[â‹ˆ"attr",â‹ˆ"val"]â€¿âŸ¨âŸ©âŸ© â‰¡ P "<tag attr=""val""></tag>"
! âŸ¨"tag"â€¿eâ€¿âŸ¨<"contents"âŸ©âŸ© â‰¡ P "<tag>contents</tag>"
! âŸ¨"void"â€¿eâŸ© â‰¡ P "<void/>"
! âŸ¨"void"â€¿["id"â€¿"attr","id"â€¿"val"]âŸ© â‰¡ P "<void id=""id"" attr=""val""/>"

! âŸ¨"void"â€¿["a"â€¿"b",">'> "â€¿"; "">"]âŸ© â‰¡ P "<void a="">'> "" b='; "">'/>"

! âŸ¨"tag"â€¿eâ€¿âŸ¨<"text"âŸ©âŸ© â‰¡ P "<tag>text</tag>"
! (â‹ˆËœ"tag"â€¿eâ€¿âŸ¨<"qu'ote"âŸ©) â‰¡ P âˆ¾Ëœ"<tag>qu'ote</tag>"
! âŸ¨"tag"â€¿eâ€¿âŸ¨<">>>"âŸ©âŸ© â‰¡ P "<tag>>>></tag>"

# Character references
#! âŸ¨"tag"â€¿eâ€¿âŸ¨<"<>&'"""âŸ©âŸ© â‰¡ P "<tag>&lt;&gt;&amp;&apos;&quot;</tag>"

# Special tags
! (â‹ˆâˆ˜< â‰¡ P) "<?xml version=""1.1""?>"
! (â‹ˆâˆ˜< â‰¡ P) "<!--<?comment<![CDATA[?>comment]]>-->"
! âŸ¨"tag"â€¿eâ€¿âŸ¨<"<![CDATA[<not>not tag</not>]]>"âŸ©âŸ© â‰¡ P "<tag><![CDATA[<not>not tag</not>]]></tag>"

# Nesting
FmtNest â† âˆ¾{ğ•Štâ€¿l:âˆ¾âŸœ(âˆ¾ğ•ŠÂ¨l)âŠ¸âˆ¾Â´("<"âˆ¾âˆ¾âŸœtâˆ¾">"Ë™)Â¨""â€¿"/"}Â¨
(! {ğ•Štâ€¿l:âŸ¨t,e,ğ•ŠÂ¨lâŸ©}Â¨ â‰¡ Pâˆ˜FmtNest)Â¨ âŸ¨
  âŸ¨"a0"â‹ˆâŸ¨"a1"â‹ˆâŸ¨âŸ©âŸ©, "b0"â‹ˆâŸ¨âŸ©, "c0"â‹ˆâŸ¨âŸ©âŸ©
  âŸ¨"a0"â‹ˆâŸ¨âŸ©, "b0"â‹ˆâŸ¨"b1"â‹ˆâŸ¨"b2"â‹ˆâŸ¨"b3"â‹ˆâŸ¨âŸ©âŸ©,"b4"â‹ˆâŸ¨âŸ©,"b5"â‹ˆâŸ¨âŸ©âŸ©âŸ©âŸ©
âŸ©

â€¢Out "All passed!"
