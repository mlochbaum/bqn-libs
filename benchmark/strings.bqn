# Missing:
# - Trim: time for long string probably not relevant?
# - Locate
# - ReplaceAll
# - _template: should be same as split mostly

âŸ¨_lineâŸ© â† â€¢Import "util.bqn"
str â† â€¢Import "../strings.bqn"
L â† 36 _line
RR â† â€¢rand.Range

Ins â† { ğ•¨ ğ•Š ğ•©: # Shuffle and insert strings ğ•¨ into ğ•©, non-overlapping
  ğ•¨ â€¢rand.Dealâˆ˜â‰ âŠ¸âŠâ†©
  a â† 1-Ëœ lâ†â‰ Â¨ğ•¨
  i â† (+`Â»a) + (â‰ ğ•¨) â€¢rand.Subset (â‰ ğ•©)-+Â´a
  (âˆ¾ğ•¨)âŒ¾((âˆ¾i+â†•Â¨l)âŠ¸âŠ) ğ•©
}

â€¢Out "Times normalized to s/MB input except where noted!"

_time â† {(1e6Ã·â‰ âˆ˜âŠ¢) Ã— ğ”½â€¢_timed}

s4 â† ' ' + 1e4 RR -Â´"\ "
Sp_t â† (1e6Ã·Â·â‰ 1âŠ‘âŠ¢) Ã— str.SplitÂ´â€¢_timed
SP â† {
  t â† 100 Sp_t ' '+âŸ¨0, 1e4 RR ğ•©âŸ©
  â€¢Out ("Split on one character in "âˆ¾Â¯2â†‘â€¢Reprğ•©) L t
;
  t â† 10 Sp_t âŸ¨ğ•¨, ((âŒˆ1e4Ã·ğ•©)â¥Š<ğ•¨) Ins s4âŸ©
  â€¢Out âŸ¨"Split on """,ğ•¨,""", 1 in ",Â¯2â†‘â€¢Reprğ•©âŸ© âˆ¾âŠ¸L t
}
SPÂ¨ 60â€¿12â€¿2â€¿1
"xy" SP 20
"separator" SP 20
"aaaa" SP 8

CE â† 3e3 str.CEscape _time âŠ¢
â€¢Out "CEscape, no escapes" L CE s4
â€¢Out "CEscape, 40% basic escapes" L CE s4 InsËœ (2e3 RR â‰ )âŠ¸âŠ'\'â‹ˆÂ¨"""'?\abefnrtv"

â€¢Out "ToBytes"   L 100 str.ToBytes _time @+1e4 RR 1e4
â€¢Out "FromBytes" L 100 str.FromBytes _time str.ToBytes @+1e4 RR 1e4

â€¢Out "ToBase64"   L 100 str.ToBase64 _time @+1e4 RR 256
â€¢Out "FromBase64" L 100 str.FromBase64 _time (1e4 RR â‰ )âŠ¸âŠ âˆ¾ (âŠ£+â†•âˆ˜Â¬Ëœ)Â¨ËË˜ âˆ˜â€¿2â¥Š"AZaz09++//"

â€¢Out "ToNats" L 100 str.ToNats _time '0'+Â¯1+1e4 RR 11
â€¢Out "ToNums" L 100 str.ToNums _time âˆ¾ ' 'âŠ¸âˆ¾Â¨â€¢ReprÂ¨ â‹†20Ã—100 RR 0

DST â† ('a'+100 RRÂ¨2â€¿100â¥Š26){
  â€¢Out (ğ•¨âˆ¾", 100 letters, seconds") L (âŠ¢Â´â‰¢ğ•—) Ã·Ëœ ğ•Â¨Ëâ€¢_timed ğ•—
}
DSTÂ´Â¨âŸ¨
  "LcsLen"     â€¿str.LcsLen
  "Lcs"        â€¿str.Lcs
  "Levenshtein"â€¿str.Levenshtein
âŸ©
