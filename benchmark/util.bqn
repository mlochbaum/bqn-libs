# Format number
# Expected to be in the range 1eÂ¯6 to 1
# Use 3 sig figs and no scientific notation
Fmt â‡ {
  s â† 3
  d â† sÂ¬âŒŠâ€¢math.Log10ğ•©   # Digits after decimal point
  t â† â€¢Repr âŒŠ0.5+ğ•©Ã—10â‹†d # Nonzero trailing digits
  (â€¢Repr âŒŠğ•©)âˆ¾"."âˆ¾(0âŒŠs-â‰ t)â†“tÂ«dâ¥Š'0'
}

# Format error margin
# Hopefully very small (~1eÂ¯10) but could be very large
# Two digits; always use scientific notation
FmtErr â‡ {
  Â¬âˆ>|ğ•©? â€¢Reprğ•© ;
  e â† âŒŠâ€¢math.Log10ğ•©
  r â† 0.5+ğ•©Ã—10â‹†1-e
  {râ‰¥100? rÃ·â†©10 â‹„ e+â†©1 ; @}
  (1(â†‘âˆ¾"."âˆ¾â†“)'0'+10(âŒŠâˆ˜Ã·Ëœâ‹ˆ|)âŒŠr)âˆ¾"e"âˆ¾â€¢Repr e
}

# Format line, expecting (2+â‰ ğ•¨)â‰¤ğ•—
_line â‡ {((ğ•—âŒˆâ‰ )âŠ¸â†‘ ğ•¨âˆ¾": ") âˆ¾ FmtâŸ(1=â€¢Type) ğ•©}

_lineErr â‡ {
  (((10+ğ•—)âŒˆâ‰ )âŠ¸â†‘âˆ¾âŸœ" " ğ•¨ ğ•—_line âŠ‘ğ•©) âˆ¾ ("(Â±"âˆ¾FmtErrâˆ¾")"Ë™)âŸ(1=â€¢Type) 1âŠ‘ğ•©
}
