_while_ â† {ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}

complex â† {
  M â‡ -Â´âˆ˜Ã—â‹ˆ+Â´âˆ˜Ã—âŸœâŒ½
  D â‡ (-âŒ¾(1âŠ¸âŠ‘) Ã· +Ëâˆ˜(Ã—Ëœ)){ğ”½âŠ˜(MâŸœğ”½)}
  A2â‡ +Â´âˆ˜Ã—Ëœ
  A â‡ âˆšA2
  Sqrt â‡ { 0<mâ†Ağ•© ? sâ€¿tâ†0>aâ€¿bâ†ğ•© â‹„ -âŸtâˆ˜âŒ½âŸs (Ã·âŸœ2â‹ˆbâŠ¸Ã·) âˆš2Ã—m+|a ; 0â€¿0 }
  _poly â‡ {+âŸœ(ğ•©âŠ¸M)Â´ğ•—}
  _polyd_ â‡ {<Ë˜â‰> (2â¥Š<ğ•˜â¥Š0) (Â»Â¨+ğ•©âŠ¸M)Â´ ğ•—}
  _polyd_ek_ â‡ {
    ekâ†0 â‹„ axâ†Ağ•©
    v â† <Ë˜â‰> (2â¥Š<ğ•˜â¥Š0) {ekâ†©(AâŠ‘Â¨ğ•©)+axÃ—ekâ‹„ğ•©}âˆ˜(Â»Â¨+ğ•©âŠ¸M)Â´ ğ•—
    vâ€¿ek
  }
}
CPoly â† â‹ˆâŸœ0âŸ(0==)Â¨

# Return all complex roots of little-endian polynomial ğ•©
# ğ•¨ gives the number of iterations
# Result is a list of realâ€¿imag pairs
WeierstrassRoots â† {
  Mâ€¿Dâ€¿_poly â† complex
  F â† (MÂ¨âŸœ(DÂ¨Â¯1âŠ¸âŠ)CPolyğ•©)_poly
  n â† â‰ ğ•©
  r0â† <Ë˜â‰> 1â€¿0 MâŸ(â†•n-1)Ëœ 4â€¿9Ã·10  # Initial roots: 0.4i0.9â‹†â†•n-1
  r â† -âŸœ(F D Â·MËÂ·â‰0(âŠ¢+1â€¿0Ã—âŒœâˆ§Ëâˆ˜=)Â·><âŠ¸-Â¨)âŸ(ğ•¨âŠ£50) r0
  <Ë˜â‰> (1eÂ¯16<|)âŠ¸Ã— r
}

# Find a root of the given polynomial with Laguerre's method
_laguerre_ â† {poly _ğ•£_ eps root:
  Mâ€¿Dâ€¿Aâ€¿A2â€¿Sqrtâ€¿_polyd_ek_ â† complex
  Jump â† (â€¢MakeRand 1).Rangeâˆ˜0 â‹„ jump_i â† 10

  nk2 â† 2 Ã· nrn â† Â¬ rn â† Ã· 1-Ëœâ‰ poly
  F â† (CPoly poly) _polyd_ek_ 3
  max_iter â† 200
  i â† 0
  âŠ¢_while_ {ğ•¤
    i < max_iter ?
    âŸ¨pâ€¿dpâ€¿d2p_h, ekâŸ© â† F root
    0 < a2p â† A2 p ?
    crit â† eps Ã— Ã—Ëœek  # Square of stopping criterion
    stop â† { a2p â‰¥      crit ? 0   # keep going
           ; a2p â‰¥ 0.01Ã—crit ? 1   # finish this iteration, then stop
           ;                   2 } # return immediately
    2 > stop ?
    dx â† {
      # Division by zero: jump in random direction
      0â€¿0 â‰¡ dp ? (1 + A root) Ã— (â€¢math.Sinâ‹ˆâ€¢math.Cos) (2Ã—Ï€) Ã— Jump i ;
      # Otherwise, Laguerre step
      fac â† pâ€¿d2p_h MÂ¨ <D dp
      (âŠ‘fac) D rnâ€¿0 + nrn Ã— -âŸ(0>âŠ‘) Sqrt 1â€¿0 - nk2 Ã— MÂ´ fac
    }
    (root -â†© dx) â‰¢ root ?
    Â¬stop ?
    i+â†©1
    # Randomly reduce length every few steps
    { 0=jump_i|i ? root +â†© dx Ã— Jump iÃ·jump_i ;@}
    1;0
  }@
  root
}
