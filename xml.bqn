# XML: Extensible Markup Language
âŸ¨
  Parse   # XML string to BQN
âŸ©â‡

# Represent text as a string
# Non-void tags are a list of:
# - Tag name
# - Attributes, as namesâ‰values
# - Contents: list of text and tags
E â† +`âŠ¸Ã—âŸœÂ¬-âŠ¢
Parse â† {
  obj â† ((+âŸœÂ»Eâˆ¨)Ë"<>"=âŒœğ•©)âŠ”ğ•©
  tag â† (â†•2)â¥ŠËœâ‰ obj
  dâ†+`ttâ†obj (1-Â·+ËœâŠ¸+Â´'/'=0â€¿Â¯1âŠâŠ£)Â¨âŒ¾(tagâŠ¸/) tag # Tag type: Â¯1 close, 0 void, 1 open
  tpâ†(â‹âŠâŸœd)âŠ¸âŠâˆ˜/Ë˜ 1â€¿Â¯1=âŒœtt            # Tag pairs
  ! (âˆ§`' 'âŠ¸â‰ )âŠ¸/Â¨âŠ¸â‰¡âŸœ(1âŠ¸â†“Â¨)ËtpâŠobj     # Tag matching
  oâ†tt>0 â‹„ câ†tt<0
  op â† ParseAttrÂ¨ o/obj
  l â† +`âŒ¾((â‹d)âŠ¸âŠ) 0<tt               # Parent index
  nvâ† â‰ vals â† (tt=0)/obj             # Initial set of values
  f â† ttâ‰¤0                           # Reduce open/closed pairs to end
  viâ† â‹â‹f/c                          # Value indices
  i â† vi âŠ (â†•nv) âˆ¾ nv+â‰ âŠ¸-c/Â»l        # Adjust for collection ordering
  op {valsâˆ¾â†©âŸ¨ğ•¨âˆ¾âŸ¨ğ•©âŠvalsâŸ©âŸ©â‹„@}Â¨â—‹âŒ½ ((+Â´c)âˆ¾Ëœ1-Ëœf/l)âŠ”i
  Â¯1âŠ‘vals
}
ParseAttr â† {
  nameâ€¿a â† (âŠ‘â‹ˆ1âŠ¸â†“) (EËœ' 'âŠ¸=>Â·â‰ `'"'âŠ¸=)âŠ¸âŠ”ğ•©
  âŸ¨name, â‰>(EËÂ·âˆ¨`"="""=âŒœâŠ¢)âŠ¸âŠ”Â¨aâŸ©
}
