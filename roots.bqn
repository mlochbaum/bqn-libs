âŸ¨
  _ITP
âŸ©â‡

_while_ â† {ğ”½âŸğ”¾âˆ˜ğ”½_ğ•£_ğ”¾âˆ˜ğ”½âŸğ”¾ğ•©}

# F is a real-valued function, and
# xâ‰¡aâ€¿b is an interval such that (F a)<0 and (F b)>0.
# Return a value at a distance of at most ğ•¨âŠ£1eÂ¯10 from a root of F.
_ITP â† { ğ•¨ F _ğ•£ x:
  e â† ğ•¨âŠ£1eÂ¯10                      # Tolerance
  w â† -ËœÂ´x                         # Initial width
  c â† 0.8Ã·w, n0â†1                  # câ†k1Ã—2â‹†k2â†2
  r0â† (n0+âŒˆ)âŒ¾(2â‹†â¼Ã·âŸœe)w             # Expected radius upper bound
  ! <â—‹(0âŠ¸<)Â´ y â† FÂ¨x               # Require bracketed and increasing
  xiâ†0                             # Result
  âŠ¢_while_ {ğ•¤
    xhâ€¿r â† (+â‹ˆ-Ëœ)Â´xÃ·2              # Midpoint and radius
    xiâ†©xh â‹„ e<r ?                  # Convergence criterion
    dâ†cÃ—Ã—Ëœr â‹„ r0Ã·â†©2                # Update constants
    xf â† x (Ã— Ã·â—‹(-Â´) âŠ¢) âŒ½y         # Interpolate
    sâ€¿xdâ†(Ã—â‹ˆ|)xf-xh                # xf = xh + sÃ—xd
    yiâ†F xi +â†© sÃ—0âŒˆ(xd-d)âŒŠr0-r     # Truncate/Project
    0â‰ yi ?                         # Stop if 0
    Uâ†(0<yi)âŠ¸âŠ‘ â‹„ x xiâŒ¾Uâ†© â‹„ y yiâŒ¾Uâ†© # Update bounds
    1;0
  }@
  xi
}
