âŸ¨
  MP, H
  uTri, qr
  Inverse
âŸ©â‡

MP â† +Ëâˆ˜Ã—â‰1â€¿âˆ  # matrix product
H  â† +â‰        # conjugate transpose

uTri â† {
  Verify â‡ {
    ! 2==ğ•©
    ! âˆ§Â´â¥Š (ğ•©=0) â‰¥ >âŒœÂ´â†•Â¨â‰¢ğ•©
  }
  Inverse â‡ (1<â‰ )â—¶Ã·â€¿{
    l â† â‰ ğ•©
    m â† âŒˆlÃ·2
    aiâ€¿di â† InverseÂ¨ mâ€¿m(â†‘â‰â—‹<â†“)ğ•©
    b â† âŸ¨m,m-lâŸ©â†‘ğ•©
    x â† - ai MP b MP di
    z â† 0 â¥ŠËœ âŸ¨l-m,mâŸ©
    âˆ¾ aiâ€¿x â‰ zâ€¿di
  }
}

# QR decomposition
qr â† {
  Compose â‡ MPÂ´
  Verify â‡ { ğ•Š qâ€¿r:
    ! âˆ§Â´2==Â¨ğ•©
    ! âˆ§Â´â‰¥â€¿={ğ•Â´â‰¢ğ•©}Â¨ğ•©
    uTri.Verify r
    ! âˆ§Â´ â¥Š 5eÂ¯14â‰¥| (=âŒœÂ´â†•Â¨âˆ˜â‰¢)âŠ¸- HâŠ¸MP q
  }
  Decompose â‡ { QR a:
    !2==a â‹„ !â‰¥Â´â‰¢a
    nâ†âŠ¢Â´â‰¢a
    (1<n)â—¶{
      a (Ã·âŸœâŠ‘ â‰â—‹< âŠ¢) âˆš HâŠ¸MP a
    }â€¿{ğ•¤
      m â†âŒˆnÃ·2
      a0â†mâ†‘Ë˜a
      a1â†mâ†“Ë˜a
      q0â€¿r0â†QR a0
      q1â€¿r1â†QR a1 - q0 MP t â† q0 HâŠ¸MP a1
      âŸ¨q0âˆ¾Ë˜q1 , (r0âˆ¾Ë˜t)âˆ¾(-n)â†‘Ë˜r1âŸ©
    }@
  }
  Inverse â‡ uTri.InverseâŠ¸MPâŸœHËœÂ´
}

# Default matrix inverse
Inverse â‡ qr.Inverse qr.Decompose
